---
layout: post
title: 配位聚合物的磷光性质计算

---

@tkaray CC-BY-NC 4.0

只是一点点计算经验, 仅供参考.
## 概述

关于磷光材料的基础理论, 可以参考以下文章, 此处不再赘述了.

_Appl. Phys. Rev._ **2022**, _9_, 011304.
*WIREs Comput. Mol. Sci.* **2012**, *2*, 187–203.

和有机磷光材料相比, 对于 RTP-CPs 和 RTP-MOFs 的过程研究依旧有一些问题, 主要集中在以下几点:

- 很多人将长时间余晖的稀土金属发光定义为磷光, 但泛泛地称为发光 (luminescence) 会更为谨慎
- 并没有搞清楚会发磷光的配体范围, 有一些已有的材料可能具有性质, 但并未报道
- 构建的计算模型较为简单, 计算内容较少, 甚至只有一个配体, 不能有效反映实际过程
- 合适的计算模型原子数一般都很大, 基本只能算的动DFT, 还只能基于基态构型

实际上这个方向已经逐渐没落 (笑), 但将不同的光学性质结合起来, 或者拓展杂化磷光材料的范围, 依旧还能做上几年. 主要的问题在于磷光材料应用范围小, 且光芒被 TADF 材料掩盖了. 好在这二者的计算是相通的. 这篇文章主要提供一些计算上的参考, 如果有后续的确定可行的内容会逐渐补充. 

### 可为与不可为

对于配位聚合物的磷光计算能做的事:
- 获得激发态的原子结构, 获得基态与T1态构型下激发态的电子结构
- 判断是否存在暗态与反 Kasha 规则的发射
- 确定电子与空穴分布, 得到发光过程的路径
- 判断 ISC 的主要路径
- 获得磷光速率 (不一定靠谱)

对于配位聚合物的磷光计算, 难做的事 (能做但很困难或不靠谱):
- 分析各种各样的外界环境导致的磷光性质变化
- 保证计算结果和实验 (紫外, 激发与发射波长) 能对应
- 获得T1以外的激发态构型
- 获得实际的MECP点结构与对应的ISC

不可能做到的事:
- 获得和实际结果完全一致的激发过程: 只能做参考, 即使是小晶胞也很难保证一定和材料一致, 大晶胞就更别想了



### 计算软件:

ORCA 是最值得用的配位聚合物磷光计算软件. 支持QM/MM, 计算速度快, 好收敛, 能算 SOCME, 还免费. 缺点是建模需要其他软件辅助, 这就八仙过海各显神通了. 话说回来, 只要能输出团簇就能建模, 选择你喜欢的 MOF 画图软件就够了.

Gaussian 不能算 SOCME, CP2K 的 SOCME 对配位聚合物磷光来说是摆设. 

磷光速率可以考虑 Dalton, 也可以考虑直接用 ORCA 算, 但**但凡是速率数据, 都不如实验分析结果靠谱.** 

## 不同计算等级及操作
### 建模的选择

参考 Chem. Rev. 2020, 120, 8641−8715. 

- 饱和所有能饱和的配位点, 否则计算结果必不准确; 实在不行就把羧基删掉. 
- 所有的无序都要被删成单套. 
- 注意氢原子! MOF 和 CP 的晶体数据都要小心处理氢的问题. 
- 电荷不要是负值, 最好是0或者较小的正值, 否则可能会算到天荒地老也得不到结果.
- 金属必须是和结构中一致的满配位, 否则就会算成MLCT过程了. 堵头可以用水或甲酸. 观察结果, 别让堵头的分子参与过程, 这样肯定是不靠谱的

### 随便做做: 算个配体

d10 过渡金属和主族金属簇一般是不会参与激发过程的, 所以只是算个配体也有个结果. 但是这样就基本只有 HOMO, LUMO 是靠谱的, CT 态就无法表征了. 羧酸配体用带氢的中性分子结构, 不要用羧酸阴离子.
### 扣个小团簇

这是一般可接受的最低等级. 结构优化过程中原子的锁定是这个等级最需要注意的事. 因为没有了外界配位键限制, 不加位置限制很大概率会散架. 可以考虑先限制所有金属原子, 如果不行就带着与金属相连的原子限制, 最后再考虑限制非氢原子. 单晶的氢原子位置是不准确的, 至少也要在结构优化过程将氢原子的位置进行优化.

团簇的大小不要超过 300 原子, 尽可能用最小不对称单元的 1-2 倍 (如果里面有一个配体的话).

### 更好的选择: QM/MM

如果能在小团簇外附加所有环境分子就是一个比较完善的计算了. 需要注意的是, high layer 依旧需要符合金属满配位的要求, 也就是说 high layer 要用配位作为外围, 包裹中间的金属. 

建模过程可以考虑先确定小团簇作为 high layer, 然后填充它周边一圈的金属和配体, 然后处理边缘裸露的羧基 (删掉比较好), 最后计算电荷. 要保证电荷是0或者比较小的正值. 100 原子的high layer 一般用不到 1000 原子就足够包裹了, 300 原子的可能要用 2000-3000 原子的 low layer 包裹. 

一个典型的 ORCA 输入文件为:

```cpp
! QM/XTB PBE0 D4 def2-SVP def2/J RIJCOSX tightSCF noautostart miniprint nopop
! moread
%moinp "cluster-qmmm.gbw"
%basis 
  newGTO Zn "def2-TZVP" end
end
%qmmm
   QMAtoms {0:64} end
   ActiveAtoms {0:64} end
   Charge_Total 0 # charge of the full system
   Mult_Total 1 # mult. of the full system
end
%tddft
nroots 20
TDA true
dosoc true
triplets true
printlevel 3
tprint 1E-8
end
%maxcore  12000
%pal nprocs  32 end
* xyz 0 1
(data)
*
```

这里使用了 QM/xTB, low layer 使用了 GFN2-xTB 半定量方法, 处理 MOF 材料应该是足够了.
### 补充周期性计算

周期性计算的电子等值面图, PDOS 和能带可以作为计算的补充, 用于验证自己模型结果的合理性, 值得一起做.


## 关于画图

参考 [使用Multiwfn做空穴-电子分析全面考察电子激发特征](http://sobereva.com/434)

## 磷光发射速率计算

这部分就参考 ORCA Manual 吧, 但算再多也没有用量子产率和发射速率得到的靠谱.

